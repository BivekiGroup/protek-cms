# We'll parse the provided DevExpress payload to extract the (x, y) pairs.
# Specifically, look for patterns like: x:new Date(YYYY,MM,DD),y:[VALUE]
# Note: JavaScript Date months are 0-based, so we'll add 1 to the month.
import re
import pandas as pd
from datetime import date
from caas_jupyter_tools import display_dataframe_to_user

raw = r"""0|/*DX*/({'id':0,'result':{'objectModel':'{d:{x:{r:{mi:new Date(2014,8,1),ma:new Date(2025,7,1),ii:24164,ia:24295},m:{t:\'D\',su:\'Month\',sa:\'Year\',sv:\'0001-01-01\'},l:[{hia:109,tx:\'01.15\',av:new Date(2015,0,1),iv:24168},{hia:110,tx:\'01.17\',av:new Date(2017,0,1),iv:24192},{hia:111,tx:\'01.19\',av:new Date(2019,0,1),iv:24216},{hia:112,tx:\'01.21\',av:new Date(2021,0,1),iv:24240},{hia:113,tx:\'01.23\',av:new Date(2023,0,1),iv:24264},{hia:114,tx:\'01.25\',av:new Date(2025,0,1),iv:24288}],cao:{f:{fs:8,ff:\'Tahoma\'},clp:\'{A:MM.yy}\',clv:false,clbc:\'#DE39CD\',tc:\'#FFFFFF\'},t:{tx:\'Axis of arguments\'},i:[{mi:24164,ma:24295}],ibc:{i:[{ibl:[{p:0,l:614}],pid:-1}]},hi:3,n:\'Primary AxisX\',x:true,id:-1,ar:false},y:{r:{mi:0,ma:3702,ii:0,ia:4072.2},m:{t:\'N\',l:false},l:[{hia:115,tx:\'0\',av:0,iv:0},{hia:116,tx:\'1000\',av:1000,iv:1000},{hia:117,tx:\'2000\',av:2000,iv:2000},{hia:118,tx:\'3000\',av:3000,iv:3000},{hia:119,tx:\'4000\',av:4000,iv:4000}],cao:{f:{fs:8,ff:\'Tahoma\'},clp:\'{V:G}\',clv:false,clbc:\'#DE39CD\',tc:\'#FFFFFF\'},t:{hia:120,tx:\'Количество предложений\'},i:[{mi:0,ma:4072.2}],ibc:{i:[{ibl:[{p:0,l:129}],pid:-1}]},hi:4,n:\'Primary AxisY\',x:false,id:-1,ar:false},dp:{lb:[{ai:-1,ax:true,lt:179,ll:66,lh:15,lw:593},{ai:-1,ax:false,lt:36,ll:25,lh:142,lw:28}],n:\'Default Pane\',paxi:-1,payi:-1,id:-1,dx:62,dy:41,dw:614,dh:129,vsb:true},t:\'XYD\',hi:1,pld:\'Vertical\',dr:false},s:[{p:[{hia:0,x:new Date(2014,8,1),y:[3],pcc:\'#DC634E\',chv:[3],ie:false,acv:[]},{hia:1,x:new Date(2014,9,1),y:[25],pcc:\'#DC634E\',chv:[25],ie:false,acv:[]},{hia:2,x:new Date(2015,0,1),y:[32],pcc:\'#DC634E\',chv:[32],ie:false,acv:[]},{hia:3,x:new Date(2015,1,1),y:[224],pcc:\'#DC634E\',chv:[224],ie:false,acv:[]},{hia:4,x:new Date(2015,2,1),y:[170],pcc:\'#DC634E\',chv:[170],ie:false,acv:[]},{hia:5,x:new Date(2015,3,1),y:[113],pcc:\'#DC634E\',chv:[113],ie:false,acv:[]},{hia:6,x:new Date(2015,4,1),y:[238],pcc:\'#DC634E\',chv:[238],ie:false,acv:[]},{hia:7,x:new Date(2015,5,1),y:[242],pcc:\'#DC634E\',chv:[242],ie:false,acv:[]},{hia:8,x:new Date(2015,6,1),y:[261],pcc:\'#DC634E\',chv:[261],ie:false,acv:[]},{hia:9,x:new Date(2015,7,1),y:[384],pcc:\'#DC634E\',chv:[384],ie:false,acv:[]},{hia:10,x:new Date(2015,8,1),y:[349],pcc:\'#DC634E\',chv:[349],ie:false,acv:[]},{hia:11,x:new Date(2015,9,1),y:[427],pcc:\'#DC634E\',chv:[427],ie:false,acv:[]},{hia:12,x:new Date(2016,0,1),y:[598],pcc:\'#DC634E\',chv:[598],ie:false,acv:[]},{hia:13,x:new Date(2016,1,1),y:[479],pcc:\'#DC634E\',chv:[479],ie:false,acv:[]},{hia:14,x:new Date(2016,2,1),y:[586],pcc:\'#DC634E\',chv:[586],ie:false,acv:[]},{hia:15,x:new Date(2016,3,1),y:[427],pcc:\'#DC634E\',chv:[427],ie:false,acv:[]},{hia:16,x:new Date(2016,4,1),y:[406],pcc:\'#DC634E\',chv:[406],ie:false,acv:[]},{hia:17,x:new Date(2016,5,1),y:[504],pcc:\'#DC634E\',chv:[504],ie:false,acv:[]},{hia:18,x:new Date(2016,6,1),y:[475],pcc:\'#DC634E\',chv:[475],ie:false,acv:[]},{hia:19,x:new Date(2016,7,1),y:[142],pcc:\'#DC634E\',chv:[142],ie:false,acv:[]},{hia:20,x:new Date(2016,8,1),y:[516],pcc:\'#DC634E\',chv:[516],ie:false,acv:[]},{hia:21,x:new Date(2016,9,1),y:[899],pcc:\'#DC634E\',chv:[899],ie:false,acv:[]},{hia:22,x:new Date(2017,0,1),y:[551],pcc:\'#DC634E\',chv:[551],ie:false,acv:[]},{hia:23,x:new Date(2017,1,1),y:[769],pcc:\'#DC634E\',chv:[769],ie:false,acv:[]},{hia:24,x:new Date(2017,2,1),y:[1114],pcc:\'#DC634E\',chv:[1114],ie:false,acv:[]},{hia:25,x:new Date(2017,3,1),y:[1096],pcc:\'#DC634E\',chv:[1096],ie:false,acv:[]},{hia:26,x:new Date(2017,4,1),y:[1186],pcc:\'#DC634E\',chv:[1186],ie:false,acv:[]},{hia:27,x:new Date(2017,5,1),y:[1051],pcc:\'#DC634E\',chv:[1051],ie:false,acv:[]},{hia:28,x:new Date(2017,6,1),y:[1229],pcc:\'#DC634E\',chv:[1229],ie:false,acv:[]},{hia:29,x:new Date(2017,7,1),y:[1408],pcc:\'#DC634E\',chv:[1408],ie:false,acv:[]},{hia:30,x:new Date(2017,8,1),y:[1238],pcc:\'#DC634E\',chv:[1238],ie:false,acv:[]},{hia:31,x:new Date(2017,9,1),y:[1378],pcc:\'#DC634E\',chv:[1378],ie:false,acv:[]},{hia:32,x:new Date(2018,0,1),y:[778],pcc:\'#DC634E\',chv:[778],ie:false,acv:[]},{hia:33,x:new Date(2018,1,1),y:[439],pcc:\'#DC634E\',chv:[439],ie:false,acv:[]},{hia:34,x:new Date(2018,2,1),y:[1679],pcc:\'#DC634E\',chv:[1679],ie:false,acv:[]},{hia:35,x:new Date(2018,3,1),y:[1386],pcc:\'#DC634E\',chv:[1386],ie:false,acv:[]},{hia:36,x:new Date(2018,4,1),y:[1465],pcc:\'#DC634E\',chv:[1465],ie:false,acv:[]},{hia:37,x:new Date(2018,5,1),y:[773],pcc:\'#DC634E\',chv:[773],ie:false,acv:[]},{hia:38,x:new Date(2018,6,1),y:[1574],pcc:\'#DC634E\',chv:[1574],ie:false,acv:[]},{hia:39,x:new Date(2018,7,1),y:[1587],pcc:\'#DC634E\',chv:[1587],ie:false,acv:[]},{hia:40,x:new Date(2018,8,1),y:[1693],pcc:\'#DC634E\',chv:[1693],ie:false,acv:[]},{hia:41,x:new Date(2018,9,1),y:[1739],pcc:\'#DC634E\',chv:[1739],ie:false,acv:[]},{hia:42,x:new Date(2019,0,1),y:[1096],pcc:\'#DC634E\',chv:[1096],ie:false,acv:[]},{hia:43,x:new Date(2019,1,1),y:[1370],pcc:\'#DC634E\',chv:[1370],ie:false,acv:[]},{hia:44,x:new Date(2019,2,1),y:[1504],pcc:\'#DC634E\',chv:[1504],ie:false,acv:[]},{hia:45,x:new Date(2019,3,1),y:[1309],pcc:\'#DC634E\',chv:[1309],ie:false,acv:[]},{hia:46,x:new Date(2019,4,1),y:[1492],pcc:\'#DC634E\',chv:[1492],ie:false,acv:[]},{hia:47,x:new Date(2019,5,1),y:[1186],pcc:\'#DC634E\',chv:[1186],ie:false,acv:[]},{hia:48,x:new Date(2019,6,1),y:[1646],pcc:\'#DC634E\',chv:[1646],ie:false,acv:[]},{hia:49,x:new Date(2019,7,1),y:[1636],pcc:\'#DC634E\',chv:[1636],ie:false,acv:[]},{hia:50,x:new Date(2019,8,1),y:[1135],pcc:\'#DC634E\',chv:[1135],ie:false,acv:[]},{hia:51,x:new Date(2019,9,1),y:[855],pcc:\'#DC634E\',chv:[855],ie:false,acv:[]},{hia:52,x:new Date(2020,0,1),y:[742],pcc:\'#DC634E\',chv:[742],ie:false,acv:[]},{hia:53,x:new Date(2020,1,1),y:[1890],pcc:\'#DC634E\',chv:[1890],ie:false,acv:[]},{hia:54,x:new Date(2020,2,1),y:[1023],pcc:\'#DC634E\',chv:[1023],ie:false,acv:[]},{hia:55,x:new Date(2020,3,1),y:[1602],pcc:\'#DC634E\',chv:[1602],ie:false,acv:[]},{hia:56,x:new Date(2020,4,1),y:[826],pcc:\'#DC634E\',chv:[826],ie:false,acv:[]},{hia:57,x:new Date(2020,5,1),y:[922],pcc:\'#DC634E\',chv:[922],ie:false,acv:[]},{hia:58,x:new Date(2020,6,1),y:[2107],pcc:\'#DC634E\',chv:[2107],ie:false,acv:[]},{hia:59,x:new Date(2020,7,1),y:[1861],pcc:\'#DC634E\',chv:[1861],ie:false,acv:[]},{hia:60,x:new Date(2020,8,1),y:[1938],pcc:\'#DC634E\',chv:[1938],ie:false,acv:[]},{hia:61,x:new Date(2020,9,1),y:[1234],pcc:\'#DC634E\',chv:[1234],ie:false,acv:[]},{hia:62,x:new Date(2021,0,1),y:[774],pcc:\'#DC634E\',chv:[774],ie:false,acv:[]},{hia:63,x:new Date(2021,1,1),y:[1658],pcc:\'#DC634E\',chv:[1658],ie:false,acv:[]},{hia:64,x:new Date(2021,2,1),y:[2047],pcc:\'#DC634E\',chv:[2047],ie:false,acv:[]},{hia:65,x:new Date(2021,3,1),y:[2158],pcc:\'#DC634E\',chv:[2158],ie:false,acv:[]},{hia:66,x:new Date(2021,4,1),y:[2820],pcc:\'#DC634E\',chv:[2820],ie:false,acv:[]},{hia:67,x:new Date(2021,5,1),y:[2851],pcc:\'#DC634E\',chv:[2851],ie:false,acv:[]},{hia:68,x:new Date(2021,6,1),y:[2353],pcc:\'#DC634E\',chv:[2353],ie:false,acv:[]},{hia:69,x:new Date(2021,7,1),y:[3219],pcc:\'#DC634E\',chv:[3219],ie:false,acv:[]},{hia:70,x:new Date(2021,8,1),y:[3124],pcc:\'#DC634E\',chv:[3124],ie:false,acv:[]},{hia:71,x:new Date(2021,9,1),y:[2863],pcc:\'#DC634E\',chv:[2863],ie:false,acv:[]},{hia:72,x:new Date(2022,0,1),y:[3702],pcc:\'#DC634E\',chv:[3702],ie:false,acv:[]},{hia:73,x:new Date(2022,1,1),y:[1845],pcc:\'#DC634E\',chv:[1845],ie:false,acv:[]},{hia:74,x:new Date(2022,2,1),y:[941],pcc:\'#DC634E\',chv:[941],ie:false,acv:[]},{hia:75,x:new Date(2022,3,1),y:[2070],pcc:\'#DC634E\',chv:[2070],ie:false,acv:[]},{hia:76,x:new Date(2022,4,1),y:[2142],pcc:\'#DC634E\',chv:[2142],ie:false,acv:[]},{hia:77,x:new Date(2022,5,1),y:[2137],pcc:\'#DC634E\',chv:[2137],ie:false,acv:[]},{hia:78,x:new Date(2022,6,1),y:[1082],pcc:\'#DC634E\',chv:[1082],ie:false,acv:[]},{hia:79,x:new Date(2022,7,1),y:[695],pcc:\'#DC634E\',chv:[695],ie:false,acv:[]},{hia:80,x:new Date(2022,8,1),y:[423],pcc:\'#DC634E\',chv:[423],ie:false,acv:[]},{hia:81,x:new Date(2022,9,1),y:[839],pcc:\'#DC634E\',chv:[839],ie:false,acv:[]},{hia:82,x:new Date(2023,0,1),y:[679],pcc:\'#DC634E\',chv:[679],ie:false,acv:[]},{hia:83,x:new Date(2023,1,1),y:[930],pcc:\'#DC634E\',chv:[930],ie:false,acv:[]},{hia:84,x:new Date(2023,2,1),y:[888],pcc:\'#DC634E\',chv:[888],ie:false,acv:[]},{hia:85,x:new Date(2023,3,1),y:[776],pcc:\'#DC634E\',chv:[776],ie:false,acv:[]},{hia:86,x:new Date(2023,4,1),y:[696],pcc:\'#DC634E\',chv:[696],ie:false,acv:[]},{hia:87,x:new Date(2023,5,1),y:[584],pcc:\'#DC634E\',chv:[584],ie:false,acv:[]},{hia:88,x:new Date(2023,6,1),y:[667],pcc:\'#DC634E\',chv:[667],ie:false,acv:[]},{hia:89,x:new Date(2023,7,1),y:[524],pcc:\'#DC634E\',chv:[524],ie:false,acv:[]},{hia:90,x:new Date(2023,8,1),y:[1256],pcc:\'#DC634E\',chv:[1256],ie:false,acv:[]},{hia:91,x:new Date(2023,9,1),y:[601],pcc:\'#DC634E\',chv:[601],ie:false,acv:[]},{hia:92,x:new Date(2024,0,1),y:[1984],pcc:\'#DC634E\',chv:[1984],ie:false,acv:[]},{hia:93,x:new Date(2024,1,1),y:[2293],pcc:\'#DC634E\',chv:[2293],ie:false,acv:[]},{hia:94,x:new Date(2024,2,1),y:[2286],pcc:\'#DC634E\',chv:[2286],ie:false,acv:[]},{hia:95,x:new Date(2024,3,1),y:[2076],pcc:\'#DC634E\',chv:[2076],ie:false,acv:[]},{hia:96,x:new Date(2024,4,1),y:[2207],pcc:\'#DC634E\',chv:[2207],ie:false,acv:[]},{hia:97,x:new Date(2024,5,1),y:[1799],pcc:\'#DC634E\',chv:[1799],ie:false,acv:[]},{hia:98,x:new Date(2024,6,1),y:[695],pcc:\'#DC634E\',chv:[695],ie:false,acv:[]},{hia:99,x:new Date(2024,7,1),y:[2067],pcc:\'#DC634E\',chv:[2067],ie:false,acv:[]},{hia:100,x:new Date(2024,8,1),y:[2112],pcc:\'#DC634E\',chv:[2112],ie:false,acv:[]},{hia:101,x:new Date(2025,0,1),y:[1760],pcc:\'#DC634E\',chv:[1760],ie:false,acv:[]},{hia:102,x:new Date(2025,1,1),y:[1962],pcc:\'#DC634E\',chv:[1962],ie:false,acv:[]},{hia:103,x:new Date(2025,2,1),y:[2350],pcc:\'#DC634E\',chv:[2350],ie:false,acv:[]},{hia:104,x:new Date(2025,3,1),y:[2239],pcc:\'#DC634E\',chv:[2239],ie:false,acv:[]},{hia:105,x:new Date(2025,4,1),y:[2156],pcc:\'#DC634E\',chv:[2156],ie:false,acv:[]},{hia:106,x:new Date(2025,5,1),y:[2071],pcc:\'#DC634E\',chv:[2071],ie:false,acv:[]},{hia:107,x:new Date(2025,6,1),y:[2162],pcc:\'#DC634E\',chv:[2162],ie:false,acv:[]},{hia:108,x:new Date(2025,7,1),y:[2151],pcc:\'#DC634E\',chv:[2151],ie:false,acv:[]}],cvi:[{v:24164,pi:0},...]});"""

# Regex to extract all (x,y) pairs
pattern = re.compile(
    r"x:new Date\((\d{4}),(\d{1,2}),(\d{1,2})\),y:\[(-?\d+(?:\.\d+)?)\]"
)

rows = []
for m in pattern.finditer(raw):
    year, month_js, day, val = m.groups()
    year = int(year)
    month = int(month_js) + 1  # JS month -> human month
    day = int(day)
    y = float(val)
    rows.append({"date": date(year, month, day), "value": y})

df = pd.DataFrame(rows)
df.sort_values("date", inplace=True)
df.reset_index(drop=True, inplace=True)

# Save to CSV for the user
csv_path = "/mnt/data/devexpress_series_xy.csv"
df.to_csv(csv_path, index=False)

display_dataframe_to_user("Extracted (date, value) pairs", df)

csv_path
